{"version":3,"file":"src_app_comentario_comentario_module_ts.js","mappings":"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","sources":["./node_modules/@capacitor/camera/dist/esm/definitions.js","./node_modules/@capacitor/camera/dist/esm/index.js","./src/app/comentario/comentario-routing.module.ts","./src/app/comentario/comentario.module.ts","./src/app/comentario/comentario.page.ts","./src/app/comentario/comentario.page.html"],"sourcesContent":["export var CameraSource;\n(function (CameraSource) {\n    /**\n     * Prompts the user to select either the photo album or take a photo.\n     */\n    CameraSource[\"Prompt\"] = \"PROMPT\";\n    /**\n     * Take a new photo using the camera.\n     */\n    CameraSource[\"Camera\"] = \"CAMERA\";\n    /**\n     * Pick an existing photo fron the gallery or photo album.\n     */\n    CameraSource[\"Photos\"] = \"PHOTOS\";\n})(CameraSource || (CameraSource = {}));\nexport var CameraDirection;\n(function (CameraDirection) {\n    CameraDirection[\"Rear\"] = \"REAR\";\n    CameraDirection[\"Front\"] = \"FRONT\";\n})(CameraDirection || (CameraDirection = {}));\nexport var CameraResultType;\n(function (CameraResultType) {\n    CameraResultType[\"Uri\"] = \"uri\";\n    CameraResultType[\"Base64\"] = \"base64\";\n    CameraResultType[\"DataUrl\"] = \"dataUrl\";\n})(CameraResultType || (CameraResultType = {}));\n","import { registerPlugin } from '@capacitor/core';\nconst Camera = registerPlugin('Camera', {\n    web: () => import('./web').then(m => new m.CameraWeb()),\n});\nexport * from './definitions';\nexport { Camera };\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { ComentarioPage } from './comentario.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ComentarioPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class ComentarioPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ComentarioPageRoutingModule } from './comentario-routing.module';\r\n\r\nimport { ComentarioPage } from './comentario.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ComentarioPageRoutingModule\r\n  ],\r\n  declarations: [ComentarioPage]\r\n})\r\nexport class ComentarioPageModule {}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Component, Input, OnInit } from '@angular/core';\r\nimport { BPMService } from '../services/bpm.service';\r\nimport { AlertService } from '../services/alert.service';\r\nimport { ActionSheetController, LoadingController, ModalController } from '@ionic/angular';\r\nimport { Storage } from '@ionic/storage-angular';\r\nimport { Camera, CameraResultType } from '@capacitor/camera';\r\n\r\n@Component({\r\n  selector: 'app-comentario',\r\n  templateUrl: './comentario.page.html',\r\n  styleUrls: ['./comentario.page.scss'],\r\n})\r\nexport class ComentarioPage implements OnInit {\r\n\r\n  @Input() ticket;\r\n  viewEntered = false;\r\n  comentarioCodigo;\r\n  comentario = '';\r\n  selectedFile;\r\n  ticketCodigo;\r\n  fileName = '';\r\n  datosUsuario;\r\n  mostrarFoto = false;\r\n  photo;\r\n  ticketNuevo: any;\r\n\r\n  constructor( private bpmService: BPMService, private alertService: AlertService, private loadingController: LoadingController,\r\n    private modalController: ModalController, private http: HttpClient, private storage: Storage,\r\n    private actionSheetController: ActionSheetController ) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  async ionViewDidEnter() {\r\n    this.viewEntered = true;\r\n    await this.loadingController.dismiss();\r\n  }\r\n\r\n  ionViewWillLeave(){\r\n    this.viewEntered = false;\r\n  }\r\n\r\n  async back(){\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  async presentLoading() {\r\n    const loading = await this.loadingController.create({\r\n      message: 'Cargando...'\r\n    });\r\n    await loading.present();\r\n  }\r\n\r\n  async comentar(){\r\n    await this.presentLoading();\r\n    (await this.bpmService.comentar(this.comentario,  this.ticket.codigo))\r\n      .subscribe(async (resp: any)=>{\r\n        console.log(resp);\r\n        if(resp.status){\r\n          this.ticketCodigo = await  resp.data.ticket_codigo;\r\n          this.comentarioCodigo = await resp.data.comentario_codigo;\r\n          await this.post();\r\n          setTimeout(async () => {\r\n            await (await this.bpmService.getTicket(this.ticketCodigo)).subscribe(async (res: any)=>{\r\n              this.ticketNuevo = await res.data;\r\n              await this.alertService.presentToast('Comentario agregado correctamente', 'success', 2500);\r\n              await this.modalController.dismiss(this.ticketNuevo);\r\n            });\r\n          }, 500);\r\n        }else{\r\n          this.alertService.presentAlert(resp.message);\r\n        }\r\n      });\r\n  }\r\n\r\n  async onFileSelected(event) {\r\n    this.datosUsuario = await this.storage.get('datos');\r\n    this.selectedFile = event.target.files[0];\r\n    this.fileName = this.selectedFile.name;\r\n}\r\n\r\n  async post(){\r\n    if (this.selectedFile) {\r\n      console.log(this.selectedFile);\r\n      const formData = new FormData();\r\n\r\n      formData.append('documento', this.selectedFile);\r\n\r\n      // eslint-disable-next-line max-len\r\n      const upload$ = this.http.post(`https://gt.disatel.app/ROOT/API/API_ticket_foto.php?&ticket=${this.ticketCodigo}&usuario=${this.datosUsuario.codigo}&comentario=${this.comentarioCodigo}`, formData);\r\n\r\n      upload$.subscribe(resp =>{\r\n        console.log(resp);\r\n      });\r\n  }\r\n  }\r\n\r\n  async takePicture(){\r\n\r\n      const image = await Camera.getPhoto({\r\n        quality: 70,\r\n        allowEditing: false,\r\n        resultType: CameraResultType.Base64,\r\n        promptLabelHeader: 'Seleccionar método',\r\n        promptLabelPhoto: 'Galería',\r\n        promptLabelPicture: 'Tomar fotografía',\r\n        presentationStyle: 'popover'\r\n      });\r\n\r\n      const imageUrl = await 'data:image/jpeg;base64,' + image.base64String;\r\n      this.photo = await imageUrl;\r\n      this.selectedFile = await this.dataURLtoFile(imageUrl, 'image');\r\n      this.datosUsuario = await this.storage.get('datos');\r\n      this.mostrarFoto = await true;\r\n  }\r\n\r\n  dataURLtoFile(dataurl, filename) {\r\n    // eslint-disable-next-line one-var\r\n    let arr = dataurl.split(','),\r\n      mime = arr[0].match(/:(.*?);/)[1],\r\n      bstr = atob(arr[1]),\r\n      n = bstr.length,\r\n      u8arr = new Uint8Array(n);\r\n    while (n--){\r\n        u8arr[n] = bstr.charCodeAt(n);\r\n    }\r\n    return new File([u8arr], filename, {type: mime});\r\n}\r\n\r\n}\r\n","export default \"<ion-header *ngIf=\\\"viewEntered\\\" class=\\\"animate__animated animate__fadeInDown\\\">\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button (click)=\\\"back()\\\" color=\\\"light\\\">Atrás\\r\\n        <ion-icon slot=\\\"start\\\" name=\\\"arrow-back-outline\\\" color=\\\"light\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Comentario</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content *ngIf=\\\"viewEntered\\\" class=\\\"animate__animated animate__fadeInUp\\\">\\r\\n<br>\\r\\n  <ion-list>\\r\\n    <ion-item>\\r\\n      <ion-label>Comentario :</ion-label>\\r\\n      <ion-textarea rows=\\\"6\\\" placeholder=\\\"Comentario...\\\" [(ngModel)]=\\\"comentario\\\">  </ion-textarea>\\r\\n    </ion-item>\\r\\n  </ion-list>\\r\\n<br>\\r\\n\\r\\n  <div *ngIf=\\\"mostrarFoto\\\">\\r\\n      <img [src]=\\\"photo\\\" class=\\\"imageDefault\\\">\\r\\n  </div>\\r\\n\\r\\n<ion-row>\\r\\n  <ion-col size=\\\"3.5\\\"></ion-col>\\r\\n  <ion-col size=\\\"4\\\">\\r\\n    <ion-button  style=\\\"--background: #c54f4d;\\\" class=\\\"upload-btn\\\"\\r\\n            (click)=\\\"takePicture()\\\">\\r\\n            Subir imágen\\r\\n             <ion-icon slot=\\\"start\\\" name=\\\"cloud-upload\\\" ></ion-icon>\\r\\n    </ion-button>\\r\\n  </ion-col>\\r\\n  <ion-col size=\\\"4\\\"></ion-col>\\r\\n</ion-row>\\r\\n\\r\\n<input type=\\\"file\\\" class=\\\"file-input\\\"\\r\\n(change)=\\\"onFileSelected($event)\\\" #fileUpload>\\r\\n\\r\\n<div class=\\\"file-upload\\\">\\r\\n  <ion-row>\\r\\n      <ion-col size=\\\"3.5\\\"></ion-col>\\r\\n      <ion-col size=\\\"4\\\">\\r\\n        <ion-button mat-mini-fab style=\\\"--background: #c54f4d;\\\" class=\\\"upload-btn\\\"\\r\\n        (click)=\\\"fileUpload.click()\\\">\\r\\n        Subir archivo\\r\\n         <ion-icon slot=\\\"start\\\" name=\\\"cloud-upload\\\" ></ion-icon>\\r\\n        </ion-button>\\r\\n      </ion-col>\\r\\n      <ion-col size=\\\"4\\\"></ion-col>\\r\\n  </ion-row>\\r\\n<ion-text style=\\\"text-align: center;\\\">\\r\\n  <h6>{{fileName || \\\"Aún no se ha subido ningún archivo.\\\"}}</h6>\\r\\n</ion-text>\\r\\n</div>\\r\\n\\r\\n\\r\\n\\r\\n  <ion-row>\\r\\n    <ion-col size=\\\"3\\\"></ion-col>\\r\\n    <ion-col size=\\\"6\\\">\\r\\n      <ion-button expand=\\\"block\\\" class=\\\"button-save\\\" strong=\\\"true\\\" (click)=\\\"comentar()\\\">Guardar\\r\\n                <ion-icon slot=\\\"start\\\" color=\\\"white\\\" name=\\\"save\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-col>\\r\\n    <ion-col size=\\\"3\\\"></ion-col>\\r\\n  </ion-row>\\r\\n\\r\\n</ion-content>\\r\\n\";"],"names":[],"sourceRoot":"webpack:///"}